@echo off
chcp 65001 >nul
echo ==========================================
echo   –°–∏—Å—Ç–µ–º–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è - –õ–∞–≥–µ—Ä—å "–ü–∞—Ä—É—Å"
echo ==========================================
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Node.js
where node >nul 2>nul
if %errorlevel% neq 0 (
    echo ‚ùå –û–®–ò–ë–ö–ê: Node.js –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!
    echo –°–∫–∞—á–∞–π—Ç–µ —Å https://nodejs.org/
    pause
    exit /b 1
)

echo [1/3] ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
if not exist "node_modules" (
    echo    –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
    call npm install
    if %errorlevel% neq 0 (
        echo ‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏!
        pause
        exit /b 1
    )
) else (
    echo    –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
)

echo.
echo [2/3] ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...
if not exist "src\database\voting.db" (
    echo    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...
    call npm run init-db
    if %errorlevel% neq 0 (
        echo ‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö!
        pause
        exit /b 1
    )
) else (
    echo    –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
)

echo.
echo [3/3] ‚úì –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã...
echo.

echo    –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞...
start "–°–µ—Ä–≤–µ—Ä –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è" cmd /k "npm start"

timeout /t 3 >nul

echo    –ó–∞–ø—É—Å–∫ VK –±–æ—Ç–∞...
start "VK –ë–æ—Ç" cmd /k "node src/bot.js"

echo.
echo ==========================================
echo   ‚úÖ –°–ò–°–¢–ï–ú–ê –ó–ê–ü–£–©–ï–ù–ê –£–°–ü–ï–®–ù–û!
echo ==========================================
echo.
echo üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:3000
echo üîê –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:  http://localhost:3000/admin
echo.
echo üìù –õ–æ–≥–∏–Ω:  admin
echo üîë –ü–∞—Ä–æ–ª—å: Admin123!
echo.
echo ‚ö†Ô∏è  –í–ê–ñ–ù–û: –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞!
echo.
echo üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –æ—Ç–∫—Ä–æ–π—Ç–µ –ö–ê–ö_–ó–ê–ü–£–°–¢–ò–¢–¨.txt
echo.
pause
